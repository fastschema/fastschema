"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[547],{15e3:function(e,t,l){l.d(t,{T:function(){return d}});var s=l(57437),a=l(29069),r=l(62985),n=l(95601),i=l.n(n);let d=e=>{var t;let{title:l,description:n,error:d}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i(),{children:(0,s.jsx)("title",{children:null!=l?l:"Error"})}),(0,s.jsxs)(a.bZ,{variant:"destructive",children:[(0,s.jsx)(r.Z,{size:16,className:"mr-2"}),(0,s.jsx)(a.Cd,{children:null!=l?l:"Error"}),(null==d?void 0:d.message)||n&&(0,s.jsx)(a.X,{children:null!==(t=null==d?void 0:d.message)&&void 0!==t?t:n})]})]})}},18157:function(e,t,l){l.d(t,{EC:function(){return a},l:function(){return r},mb:function(){return n}});var s=l(31548);let a=e=>(null==e?void 0:e.type)==="m2m"||(null==e?void 0:e.type)==="o2m"&&!!(null==e?void 0:e.owner),r=(e,t,l,s,a,r)=>{if(!s){if(e.length){l(e[0]);return}if(!e.length&&t.length){l(a?null:void 0);return}l(a?null:void 0);return}let n=e.map(e=>({id:e.id})),i=n.length?n:void 0,d=t.map(e=>({id:e.id})),c=d.length?d:void 0,o=(null==i?void 0:i.length)||!a?i:null;l(r?{$add:i,$clear:c}:o)},n=async(e,t,l,a,r)=>{if(!a||!e.relation)return;let n={};if(t&&(n[a.label_field]={$like:"%".concat(t,"%")}),r){let t=e.relation.field;n["".concat(t,".id")]=r}return await (0,s.Q7)(a.name,{page:l,limit:20,filter:Object.keys(n).length?n:void 0,select:"id,".concat(a.label_field)})}},65547:function(e,t,l){l.d(t,{L:function(){return y},Z:function(){return N}});var s=l(57437),a=l(2265),r=l(22169),n=l(3428),i=l(50489),d=l(49108),c=l(37805),o=l(52235),m=l(57654),u=l(76540),x=l(31548),f=l(75006),h=l(15e3),p=l(93412),g=l(27453),v=l(15370);let j=(0,s.jsx)(n.Z,{className:"w-[50%] text-slate-300",width:"50%",height:"50%"}),y=e=>{var t;let{showUploader:l,onInsert:r,multiple:n}=e,[o,j]=(0,a.useState)(1),[y,b]=(0,a.useState)([]),[w,k]=(0,a.useState)([]),{data:$,isLoading:z,error:C,refetch:S}=(0,u.a)({queryKey:["media",o],queryFn:()=>(0,x.Q7)("file",{limit:20,page:null!=o?o:void 0}),retry:0}),_=e=>{if(n)return b(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]);b(y.includes(e)?[]:[e])};return C?(0,s.jsx)(h.T,{error:C}):(0,s.jsxs)("div",{className:"space-y-5 relative h-full",children:[(0,s.jsxs)("div",{className:"flex items-center p-1 bg-muted flex-1 rounded-lg sticky top-0 justify-between z-10",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[l&&(0,s.jsx)(v.Q,{minimal:!0,onMediaUploaded:e=>k(t=>[e,...t]),onUploadComplete:()=>{k([]),S()}}),r&&(0,s.jsx)(m.z,{size:"sm",onClick:()=>r(y),disabled:!y.length,children:"Insert"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 pr-2",children:[(0,s.jsxs)(m.z,{size:"sm",variant:"link",disabled:!y.length,onClick:()=>{y.length&&(async()=>{if(confirm("Are you sure to delete selected medias?"))try{await (0,p.c1)(y.map(e=>e.id)),await S(),b([]),g.h4.success("Medias deleted successfully")}catch(e){}})()},className:"text-red-500 hover:text-red-600",children:[(0,s.jsx)(i.Z,{className:"mr-2 h-4 w-4"}),y.length?"Delete selected (".concat(y.length,")"):"Delete selected"]}),(0,s.jsxs)(m.z,{variant:"outline",size:"sm",disabled:1===o,onClick:()=>{o>1&&j(o-1)},children:[(0,s.jsx)(d.Z,{className:"mr-2 h-4 w-4"}),"Previous"]}),(0,s.jsxs)(m.z,{variant:"outline",size:"sm",disabled:o===(null==$?void 0:$.last_page),onClick:()=>{var e;o<(null!==(e=null==$?void 0:$.last_page)&&void 0!==e?e:1)&&j(o+1)},children:["Next",(0,s.jsx)(c.Z,{className:"ml-2 h-4 w-4"})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[o," of ",null==$?void 0:$.last_page]})})]})]}),z?(0,s.jsx)(f.g,{}):(0,s.jsxs)("div",{className:"flex flex-wrap gap-5",children:[w.map(e=>(0,s.jsx)(N,{media:e,selectedMedias:y,onClick:_},e.id)),(null!==(t=null==$?void 0:$.items)&&void 0!==t?t:[]).map(e=>(0,s.jsx)(N,{media:e,selectedMedias:y,onClick:_},e.id))]})]})},N=e=>{let{media:t,onClick:l,selectedMedias:a,wrapperClassName:n,hideInfo:i,onUnAttach:d}=e,c=!!(null!=a?a:[]).filter(e=>e.id===t.id).length,m=(0,r.cn)("cursor-pointer rounded-md overflow-hidden bg-slate-100 border hover:shadow-lg",c&&"border-2 border-amber-300 shadow-sm hover:shadow-amber-100");return(0,s.jsxs)("div",{className:(0,r.cn)("flex flex-wrap w-full sm:w-full md:w-[200px] xl:w-[230px] relative",n),role:"none",onClick:()=>null==l?void 0:l(t),children:[d&&(0,s.jsx)("div",{className:"absolute top-1 right-1 z-10",children:(0,s.jsx)("button",{type:"button",onClick:()=>d(t),className:"p-1 rounded-full bg-slate-200 hover:bg-slate-300",children:(0,s.jsx)(o.Z,{className:"h-3 w-3"})})}),(0,s.jsxs)("div",{className:m,children:[(0,s.jsx)("div",{className:"flex w-full aspect-square items-center justify-center p-1 bg-slate-50",children:t.type.startsWith("image/")?(0,s.jsx)("img",{className:"max-h-full object-contain object-center rounded-sm",alt:t.name,src:t.url}):j}),!i&&(0,s.jsx)("div",{className:"flex-1 p-3 border-t",children:(0,s.jsxs)("div",{className:"space-y-1 text-sm break-words",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:t.type.split(";")[0]}),(0,s.jsx)("h3",{className:"font-medium leading line-clamp-1",children:t.name})]})})]})]})}},15370:function(e,t,l){l.d(t,{Q:function(){return p}});var s=l(57437),a=l(2265),r=l(94509),n=l(62985),i=l(54739),d=l(3428);let c=e=>{let{file:t}=e,[l,r]=(0,a.useState)(),n=(0,s.jsx)(d.Z,{className:"w-[40px] text-slate-500",width:40,height:40});return((0,a.useEffect)(()=>{if(!t||!t.type.startsWith("image/"))return;let e=new FileReader;e.onload=()=>{r(e.result)},e.readAsDataURL(t)},[t]),t&&t.type.startsWith("image/")&&l)?(0,s.jsx)("img",{className:"h-auto rounded-lg",src:l,alt:""}):n};var o=l(5887),m=l(93412),u=l(22169),x=l(57654),f=l(62677),h=l(97081);let p=e=>{let{uploadContainerClass:t,minimal:l,onMediaUploaded:d,onUploadComplete:p}=e,[g,v]=(0,a.useState)({}),[j,y]=(0,a.useState)(""),[N,b]=(0,a.useState)([]),{getRootProps:w,getInputProps:k,isDragActive:$,acceptedFiles:z}=(0,i.uI)();return(0,a.useEffect)(()=>{z.length&&(async()=>{let e=0;for(let s=0;s<z.length;s++)try{var t,l;v(e=>({...e,[s]:"uploading"}));let a=await (0,m.cT)(z[s]);(null==a?void 0:null===(t=a.success)||void 0===t?void 0:t.length)?v(e=>({...e,[s]:"success"})):v(e=>({...e,[s]:"error"})),e++,y("".concat(e,"/").concat(z.length)),null==d||d(null==a?void 0:null===(l=a.success)||void 0===l?void 0:l[0])}catch(e){v(t=>{var l;return{...t,[s]:null!==(l=e.message)&&void 0!==l?l:"Unknown error"}}),b(t=>{var l;return[...t,"".concat(z[s].name,": ").concat(null!==(l=e.message)&&void 0!==l?l:"Unknown error")]})}await (0,h._v)(1e3),null==p||p()})()},[z]),(0,s.jsxs)("div",{className:"space-y-5",children:[l?(0,s.jsxs)("div",{className:"flex flex-row space-x-2 align-middle items-center",children:[(0,s.jsxs)("div",{...w(),children:[(0,s.jsx)("input",{...k(),type:"file",className:"hidden"}),(0,s.jsxs)(x.z,{size:"sm",variant:"outline",children:[(0,s.jsx)(r.Z,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Upload"})]})]}),j&&(0,s.jsxs)("div",{className:"flex flex-row align-middle items-center gap-1 text-sm",children:[(0,s.jsx)("span",{children:j}),!!N.length&&(0,s.jsx)(f.pn,{children:(0,s.jsxs)(f.u,{children:[(0,s.jsx)(f.aJ,{children:(0,s.jsx)(n.Z,{className:"w-4 h-4 text-red-600 dark:text-red-400"})}),(0,s.jsx)(f._v,{children:N.map(e=>(0,s.jsx)("p",{className:"text-red-600 dark:text-red-400",children:e},e))})]})})]})]}):(0,s.jsxs)("div",{...w(),className:(0,u.cn)("flex flex-col items-center justify-center w-full h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600",t),children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[(0,s.jsx)(r.Z,{className:"w-8 h-8 mb-4 text-gray-500 dark:text-gray-400"}),(0,s.jsx)("p",{className:"mb-2 text-sm text-gray-500 dark:text-gray-400",children:$?"Drop the files here ...":"Drag and drop some files here, or click to select files"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"SVG, PNG, JPG, GIF, PDF, DOCX, XLSX..."})]}),(0,s.jsx)("input",{...k(),id:"dropzone-file",type:"file",className:"hidden"})]}),!l&&z.length?(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)(o.iA,{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-600",children:[(0,s.jsx)(o.xD,{className:"bg-gray-50 dark:bg-gray-700",children:(0,s.jsxs)(o.SC,{className:"text-gray-800 dark:text-gray-300",children:[(0,s.jsx)(o.ss,{scope:"col",className:"p-3.5 px-2 text-sm text-start font-semibold"}),(0,s.jsx)(o.ss,{scope:"col",className:"p-3.5 px-2 text-sm text-start font-semibold min-w-[10rem]",children:"Name"}),(0,s.jsx)(o.ss,{scope:"col",className:"p-3.5 px-2 text-sm text-start font-semibold min-w-[10rem]",children:"Type"}),(0,s.jsx)(o.ss,{scope:"col",className:"p-3.5 px-2 text-sm text-start font-semibold min-w-[6rem]",children:"Size"}),(0,s.jsx)(o.ss,{scope:"col",className:"p-3.5 px-2 text-sm text-start font-semibold min-w-[6rem]",children:"Status"}),(0,s.jsx)(o.ss,{scope:"col",className:"p-3.5 px-2 text-sm text-start font-semibold min-w-[8rem]",children:"Action"})]})}),(0,s.jsx)(o.RM,{className:"divide-y divide-gray-200 dark:divide-gray-600",children:z.map((e,t)=>{var l;let a=null!==(l=g[t])&&void 0!==l?l:"pending";return(0,s.jsxs)(o.SC,{children:[(0,s.jsx)(o.pj,{className:"p-2 max-w-[50px] flex items-center",children:(0,s.jsx)(c,{file:e})}),(0,s.jsx)(o.pj,{className:"p-2 text-sm text-gray-700 dark:text-gray-400 font-medium",children:e.name}),(0,s.jsx)(o.pj,{className:"p-2 text-sm text-gray-700 dark:text-gray-400",children:(0,s.jsx)("p",{children:e.type})}),(0,s.jsxs)(o.pj,{className:"p-2 text-sm text-gray-700 dark:text-gray-400",children:[e.size," bytes"]}),(0,s.jsx)(o.pj,{className:"p-2 text-sm text-gray-700 dark:text-gray-400",children:a}),(0,s.jsx)(o.pj,{className:"p-2 text-sm text-gray-700 dark:text-gray-400",children:"success"===a&&(0,s.jsxs)("div",{className:"flex space-x-2 items-center justify-center w-full h-full text-sm",children:[(0,s.jsx)("a",{href:"/link-to-file",className:"hover:underline text-blue-800",target:"_blank",rel:"noreferrer",children:"View"}),(0,s.jsx)("button",{className:"cursor-pointer hover:underline text-red-800",type:"button",children:"Delete"})]})})]},e.name)})})]})}):null]})}},29069:function(e,t,l){l.d(t,{Cd:function(){return c},X:function(){return o},bZ:function(){return d}});var s=l(57437),a=l(2265),r=l(57742),n=l(22169);let i=(0,r.j)("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=a.forwardRef((e,t)=>{let{className:l,variant:a,...r}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(i({variant:a}),l),...r})});d.displayName="Alert";let c=a.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,s.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",l),...a})});c.displayName="AlertTitle";let o=a.forwardRef((e,t)=>{let{className:l,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",l),...a})});o.displayName="AlertDescription"},62677:function(e,t,l){l.d(t,{_v:function(){return o},aJ:function(){return c},pn:function(){return i},u:function(){return d}});var s=l(57437),a=l(2265),r=l(38152),n=l(22169);let i=r.zt,d=r.fC,c=r.xz,o=a.forwardRef((e,t)=>{let{className:l,sideOffset:a=4,...i}=e;return(0,s.jsx)(r.VY,{ref:t,sideOffset:a,className:(0,n.cn)("z-50 overflow-hidden rounded-md bg-primary px-3 py-1.5 text-xs text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",l),...i})});o.displayName=r.VY.displayName},31548:function(e,t,l){l.d(t,{Q7:function(){return i},Vj:function(){return r},il:function(){return d},rP:function(){return n},yd:function(){return c}});var s=l(18157),a=l(84971);let r=async(e,t,l)=>{let r={$add:{},$set:{},$clear:{}};for(let a of e.fields)if(a.name in t||a.is_system_field){if("relation"===a.type||"media"===a.type){var n,i;if(l){if(null===t[a.name]){r.$clear[a.name]=!0;continue}if(t[a.name].$nochange)continue;if(!(0,s.EC)(a.relation)){r.$set[a.name]=t[a.name];continue}t[a.name].$add&&(r.$add[a.name]=t[a.name].$add),t[a.name].$clear&&(r.$clear[a.name]=t[a.name].$clear);continue}if(null==t?void 0:null===(n=t[a.name])||void 0===n?void 0:n.$add){r[a.name]=t[a.name].$add;continue}if(null==t?void 0:null===(i=t[a.name])||void 0===i?void 0:i.$clear){delete r[a.name];continue}}r[a.name]=t[a.name]}return 0===Object.keys(r.$add).length&&delete r.$add,0===Object.keys(r.$set).length&&delete r.$set,0===Object.keys(r.$clear).length&&delete r.$clear,l?await (0,a.qb)("/content/".concat(e.name,"/").concat(l),r):await (0,a.SO)("/content/".concat(e.name),r)},n=e=>{let t={};return(null==e?void 0:e.limit)&&(t.limit=e.limit),(null==e?void 0:e.page)&&(t.page=e.page),(null==e?void 0:e.sort)&&(t.sort=e.sort),(null==e?void 0:e.select)&&(t.select=e.select),(null==e?void 0:e.filter)&&(t.filter=JSON.stringify(e.filter)),new URLSearchParams(t).toString()},i=async(e,t)=>{if(!e)throw Error("Schema name is required");let l={};(null==t?void 0:t.limit)&&(l.limit=t.limit),(null==t?void 0:t.page)&&(l.page=t.page),(null==t?void 0:t.sort)&&(l.sort=t.sort),(null==t?void 0:t.select)&&(l.select=t.select),(null==t?void 0:t.filter)&&(l.filter=JSON.stringify(t.filter));let s=Object.keys(l).length>0?"?"+n(t):"";return(0,a.dX)("/content/".concat(e).concat(s))},d=async(e,t,l)=>{let s=(null==l?void 0:l.length)?"?select=".concat(l.join(",")):"";return(0,a.dX)("/content/".concat(e.name,"/").concat(t).concat(s))},c=async(e,t)=>(0,a.HG)("/content/".concat(e,"/").concat(t))},93412:function(e,t,l){l.d(t,{c1:function(){return r},cT:function(){return a}});var s=l(84971);let a=async e=>{let t=new FormData;return t.append("file",e),await (0,s.SO)("/file/upload",t,{headers:{"Content-Type":"multipart/form-data"}})},r=async e=>await (0,s.HG)("/file",e)}}]);